function countdown(t){return{restrict:"A",link:function(e,o,n){function r(t){return c=49>=t?"#f33155":74>=t?"#F4D35E":"#43c8c0"}var i,c,a=o[0].getContext("2d"),l=o[0].width/2,u=o[0].height/2,s=90,f=0*Math.PI,p=!1,d=function(t){a.clearRect(0,0,2*l,2*u);var e=.02*t;i=e*Math.PI,a.beginPath(),a.arc(l,u,s,f,i,p),a.lineWidth=15,a.strokeStyle=r(t),a.stroke()};e.$watch("nextUpdatePerc",function(){t(d(e.nextUpdatePerc),1)})}}}!function(){"use strict";angular.module("tweetstockr",["ngRoute","angular-chartist","ui-notification"]).constant("CONFIG",{apiUrl:"http://localhost:4000"}).config(["$routeProvider","$locationProvider","NotificationProvider",function(t,e,o){t.when("/market",{templateUrl:"partials/market.html",controller:"marketController"}).when("/market/:tab",{templateUrl:"partials/market.html",controller:"marketController"}).when("/market/:tab",{templateUrl:"partials/market.html",controller:"marketController"}).when("/wallet",{templateUrl:"partials/wallet.html",controller:"walletController"}).when("/ranking",{templateUrl:"partials/ranking.html",controller:"rankingController"}).when("/tournaments",{templateUrl:"partials/tournaments.html",controller:"tournamentsController"}).when("/profile",{templateUrl:"partials/profile.html",controller:"profileController"}).otherwise({redirectTo:"/market"}),o.setOptions({delay:1e3,startTop:20,startRight:10,verticalSpacing:20,horizontalSpacing:20,positionX:"right",positionY:"top"})}])}(),function(){"use strict";function t(t,e){return{getRanking:function(o,n){e.get(t.apiUrl+"/ranking",function(t){o(t)},function(t){n(t)})}}}t.$inject=["CONFIG","networkService"],angular.module("tweetstockr").factory("leaderboardService",t)}(),function(){"use strict";function t(t,e,o){return{buy:function(n,r,i,c){o.postAuth(e.apiUrl+"/trade/buy",{stock:n,amount:r},function(e){t.updateCurrentUser(),i(e)},function(t){c(t)})},sell:function(n,r,i){o.postAuth(e.apiUrl+"/trade/sell",{trade:n},function(e){t.updateCurrentUser(),r(e)},function(t){i(t)})}}}t.$inject=["$rootScope","CONFIG","networkService"],angular.module("tweetstockr").factory("marketService",t)}(),function(){"use strict";function t(t){return{postAuth:function(e,o,n,r){t({method:"POST",url:e,headers:{"Content-Type":"application/x-www-form-urlencoded"},transformRequest:function(t){var e=[];for(var o in t)e.push(encodeURIComponent(o)+"="+encodeURIComponent(t[o]));return e.join("&")},data:o,withCredentials:!0}).then(function(t){t.data.redirect_to&&(window.location=t.data.redirect_to),t.data.success?n(t.data):r(t.data||{message:"Sorry! An error ocurred."})},function(t){r({message:"Error: Could not connect to the server."}),console.log("Authenticated POST error: "+t)})},getAuth:function(e,o,n){t({method:"GET",url:e,withCredentials:!0}).then(function(t){t.data.redirect_to&&(window.location=t.data.redirect_to),o(t.data)},function(t){n({message:"Error: Could not connect to the server."}),console.log("Authenticated GET error: "+t)})},get:function(e,o,n){t({method:"GET",url:e}).then(function(t){t.data.redirect_to&&(window.location=t.data.redirect_to),o(t.data)},function(t){n({message:"Error: Could not connect to the server."}),console.log("GET error: "+t)})}}}t.$inject=["$http"],angular.module("tweetstockr").factory("networkService",t)}(),function(){"use strict";function t(t,e){return{getPortfolio:function(o,n){e.getAuth(t.apiUrl+"/portfolio",function(t){o(t)},function(t){n(t)})}}}t.$inject=["CONFIG","networkService"],angular.module("tweetstockr").factory("portfolioService",t)}(),function(){"use strict";function t(t,e){return{getActiveTournaments:function(o,n){e.getAuth(t.apiUrl+"/tournaments",function(t){o(t)},function(t){n(t)})}}}t.$inject=["CONFIG","networkService"],angular.module("tweetstockr").factory("tournamentService",t)}(),function(){"use strict";function t(t,e,o,n){return{getProfile:function(t,e){o.getAuth(n.apiUrl+"/profile",function(e){t(e)},function(t){e(t)})},getBalance:function(t,e){o.getAuth(n.apiUrl+"/balance",function(e){t(e)},function(t){e(t)})},resetAccount:function(t,r){o.postAuth(n.apiUrl+"/reset",{},function(o){e.updateCurrentUser(),t(o)},function(t){r(t)})}}}t.$inject=["$http","$rootScope","networkService","CONFIG"],angular.module("tweetstockr").factory("userService",t)}(),function(){"use strict";function t(t,e,o,n){return{getTransactions:function(t,e){o.getAuth(n.apiUrl+"/statement",function(e){t(e)},function(t){e(t)})},getStats:function(t,e){o.getAuth(n.apiUrl+"/stats",function(e){t(e)},function(t){e(t)})}}}t.$inject=["$http","$rootScope","networkService","CONFIG"],angular.module("tweetstockr").factory("walletService",t)}(),angular.module("tweetstockr").directive("countdown",["$timeout",countdown]),function(){"use strict";angular.module("tweetstockr").directive("navbar",function(){return{restrict:"E",templateUrl:"components/header.html",controller:"headerController"}})}(),function(){"use strict";function t(t,e,o){t.updateCurrentUser=function(){o.getProfile(function(t){e.username=t.user.twitter.displayName,e.twitterUser=t.user.twitter.username,e.balance=t.balance,e.ranking=t.ranking,e.tokens=t.user.tokens,e.profileImage=t.user.twitter.profile_image,e.profileImageThumb=t.user.twitter.profile_image_normal,e.twitterUrl="https://twitter.com/"+t.user.twitter.username},function(t){console.log("Error: "+t.message)})},t.updateCurrentUser()}t.$inject=["$rootScope","$scope","userService"],angular.module("tweetstockr").controller("headerController",t)}(),function(){"use strict";function t(t,e,o,n,r,i,c){function a(t){var e=Date.parse(t)-Date.parse(new Date),o=Math.floor(e/1e3%60),n=Math.floor(e/1e3/60%60),r=Math.floor(e/36e5%24),i=Math.floor(e/864e5);return{total:e,days:i,hours:r,minutes:n,seconds:o}}function l(t){function o(){var o=a(t);if(o.total>0){var r=("0"+o.minutes).slice(-2)+":"+("0"+o.seconds).slice(-2);e.$apply(function(){e.nextUpdateIn=r,e.nextUpdatePerc=o.total/e.roundDuration*100})}else e.$apply(function(){e.nextUpdateIn="00:00",e.nextUpdatePerc=0}),clearInterval(n)}o();var n=setInterval(o,1e3)}var u=io.connect(i.apiUrl,{secure:!0,transports:["flashsocket","polling","websocket"]});e.loading=!1,u.on("connect",function(){console.log("connected!"),u.emit("update-me"),e.loading=!0}),u.on("update-date",function(t){e.roundDuration=t.roundDuration;var o=new Date(t.nextUpdate);l(o)}),u.on("update",function(t){e.stocks=t;for(var o=0;o<e.stocks.length;o++){var n=e.stocks[o],r=n.history.length;if(n.price>0&&r>1&&n.history[1].price>0){var i=100*(n.price/n.history[1].price-1);n.variation=Math.round(i).toFixed(0)+"%",n.lastMove=0>i?"danger":"success",n.icon=0>i?"fa-caret-down":"fa-caret-up"}var c={};c.labels=[],c.series=[[]];for(var a=r-1;a>=0;a--){var l=new Date(n.history[a].created),u=l.getHours()+":"+l.getMinutes();c.series[0].push(n.history[a].price),c.labels.push(u)}n.chartData=c}e.getPortfolio(),e.$apply()}),e.chartOptions={showArea:!0},e.tabs=[{title:"Shares",url:"components/shares.html",icon:"icons/shares-icon.html"},{title:"Portfolio",url:"components/portfolio.html",icon:"icons/portfolio-icon.html"}],e.currentTab="components/shares.html",e.onClickTab=function(t){"components/shares.html"===t.url?(e.currentTab=t.url,e.isActiveTab=function(t){return t===e.currentTab}):"components/portfolio.html"===t.url&&(e.currentTab=t.url,e.isActiveTab=function(t){return t===e.currentTab})},e.isActiveTab=function(t){return t===e.currentTab},e.sellShare=function(t){e.stockBtn=!0,r.sell(t.tradeId,function(t){e.getPortfolio(),c.success(t.message)},function(t){c.error(t.message)})},e.buyShare=function(t,o){e.stockBtn=!0,r.buy(t,o,function(t){c.success(t);var o=document.getElementById("audio");o.play(),e.getPortfolio()},function(t){c.error(t.message)})},e.getPortfolio=function(){o.getPortfolio(function(t){e.portfolio=t;for(var o=0;o<e.portfolio.length;o++){var n=e.portfolio[o],r=n.history.length,i={};i.labels=[],i.series=[[]];for(var c=r-1;c>=0;c--){var a=new Date(n.history[c].created),l=a.getHours()+":"+a.getMinutes();i.series[0].push(n.history[c].price),i.labels.push(l)}n.chartData=i,console.log(n)}e.loading=!0,e.stockBtn=!1},function(t){c.error(t.message),console.log("Portfolio Error: "+t.message)})}}t.$inject=["$rootScope","$scope","portfolioService","networkService","marketService","CONFIG","Notification"],angular.module("tweetstockr").controller("marketController",t)}(),function(){"use strict";function t(t,e,o,n){t.updateCurrentUser(),e.resetAccount=function(){o.resetAccount(function(t){t.message&&n.success(t.message)},function(t){t.message&&n.error(t.message)})}}t.$inject=["$rootScope","$scope","userService","Notification"],angular.module("tweetstockr").controller("profileController",t)}(),function(){"use strict";function t(t,e){t.loading=!1,e.getRanking(function(e){t.rankingList=e,t.loading=!0},function(t){console.log("error: ",JSON.stringify(t))})}t.$inject=["$scope","leaderboardService"],angular.module("tweetstockr").controller("rankingController",t)}(),function(){"use strict";function t(){}angular.module("tweetstockr").controller("shopController",t)}(),function(){"use strict";function t(t,e){t.loading=!1,e.getActiveTournaments(function(e){t.tournamentsList=e,t.loading=!0},function(t){console.log("error: ",JSON.stringify(t))})}t.$inject=["$scope","tournamentService"],angular.module("tweetstockr").controller("tournamentsController",t)}(),function(){"use strict";function t(t,e){t.loading=!1,e.getTransactions(function(e){t.transactionList=e,t.loading=!0},function(t){console.log("error: ",JSON.stringify(t))}),e.getStats(function(e){t.stats=e},function(t){console.log("error: ",JSON.stringify(t))})}t.$inject=["$scope","walletService"],angular.module("tweetstockr").controller("walletController",t)}();